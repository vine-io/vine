<!doctype html>
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.95.0" /><link rel="canonical" type="text/html" href="https://vine-io.github.io/vine/docs/quickstart/">
<link rel="alternate" type="application/rss&#43;xml" href="https://vine-io.github.io/vine/docs/quickstart/index.xml">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/vine/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/vine/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/vine/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/vine/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/vine/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/vine/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/vine/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/vine/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/vine/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/vine/favicons/android-192x192.png" sizes="192x192">

<title>å¿«é€Ÿå¼€å§‹ | Vine</title><meta property="og:title" content="å¿«é€Ÿå¼€å§‹" />
<meta property="og:description" content="Vine æ–‡æ¡£" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://vine-io.github.io/vine/docs/quickstart/" /><meta property="og:site_name" content="Vine" />

<meta itemprop="name" content="å¿«é€Ÿå¼€å§‹">
<meta itemprop="description" content="Vine æ–‡æ¡£"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="å¿«é€Ÿå¼€å§‹"/>
<meta name="twitter:description" content="Vine æ–‡æ¡£"/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<link rel="preload" href="/vine/scss/main.min.bd19fcdf38c012b14ad8d3c8432efd8cf1740a17234311f030bcb495e955a2cf.css" as="style">
<link href="/vine/scss/main.min.bd19fcdf38c012b14ad8d3c8432efd8cf1740a17234311f030bcb495e955a2cf.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/vine/">
		<span class="navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Vine</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link active" href="/vine/docs/" ><span class="active">æ–‡æ¡£</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a  class="nav-link" href="https://github.com/vine-io/examples" target="_blank" ><span>å®ä¾‹</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a  class="nav-link" href="https://github.com/vine-io/vine" target="_blank" ><span>GitHub</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 ç«™å†…æœç´¢â€¦" aria-label="ç«™å†…æœç´¢â€¦" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/vine/docs/quickstart/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">å¿«é€Ÿå¼€å§‹</h1>






<div class="content">
      <p>è¿™é‡Œæä¾›ä¸€ä¸ªç®€å•çš„å®ä¾‹ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿäº†è§£ <strong>Vine</strong> æ¡†æ¶ã€‚</p>
<h2 id="å®šä¹‰æ¥å£">å®šä¹‰æ¥å£</h2>
<h3 id="æ–°å»ºé¡¹ç›®">æ–°å»ºé¡¹ç›®</h3>
<p>æ–°å»ºç›®å½•ä¿å­˜ç›¸å…³ä»£ç :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/greet
</span></span></code></pre></div><blockquote>
<p>å»ºè®®é¡¹ç›®ä¿å­˜åœ¨ $GOPATH ä¸‹</p>
</blockquote>
<h3 id="æ–°å»º-proto-æ–‡ä»¶">æ–°å»º *.proto æ–‡ä»¶</h3>
<p><strong>Vine</strong> å†…éƒ¨ä½¿ç”¨ <code>gRPC</code> ä½œä¸ºæœåŠ¡ç«¯ï¼Œ<code>*.proto</code> æ˜¯ google å…¬å¸å¼€æºçš„ä¸€ç§æ•°æ®äº¤æ¢åè®®ï¼Œç±»ä¼¼ <code>json</code>ã€‚å…³äº <code>protobuf</code> æ›´è¯¦ç»†çš„è¯­æ³•å¯ä»¥å‚è€ƒ<a href="https://developers.google.com/protocol-buffers/docs/gotutorial">protobuf</a>ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬æ–°å»º <code>greet.proto</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-protobuf" data-lang="protobuf"><span style="display:flex;"><span><span style="color:#6272a4">// mysite/proto/greet.proto
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>syntax <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;proto3&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">package</span> greet;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">service</span> Greeter {
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">rpc</span> Echo(EchoReq) <span style="color:#ff79c6">returns</span> (EchoRsp) {}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">message</span> <span style="color:#50fa7b">EchoReq</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">string</span> name <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">message</span> <span style="color:#50fa7b">EchoRsp</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">string</span> greeting <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>æ›´å¤šçš„å…³äº <strong>Vine</strong> çš„è¯­æ³•è§„åˆ™å¯ä»¥å‚è€ƒ <a href="/vine/docs/guides/openapi/">protoc-gen-vine</a></p>
</blockquote>
<h3 id="ç”Ÿæˆ-api-æ¥å£">ç”Ÿæˆ API æ¥å£</h3>
<p>ä½ éœ€è¦ä»¥ä¸‹çš„å·¥å…·æ¥ç”Ÿæˆ proto ä»£ç </p>
<ul>
<li><a href="https://github.com/protocolbuffers/protobuf">protoc</a></li>
<li><a href="https://github.com/vine-io/vine/tree/master/cmd/protoc-gen-gogo">protoc-gen-gogo</a></li>
<li><a href="https://github.com/vine-io/vine/tree/master/cmd/protoc-gen-vine">protoc-gen-vine</a></li>
</ul>
<p>ä½¿ç”¨ protocã€protoc-gen-gogoã€protoc-gen-vine æ¥ç”Ÿæˆ protobuf code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go get github.com/gogo/protobuf
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-gogo
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-vine
</span></span></code></pre></div><p>ä½¿ç”¨å‘½ä»¤ç”Ÿæˆ <code>greet.pb.go</code> å’Œ <code>greet.vine.go</code> æ–‡ä»¶:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src
</span></span><span style="display:flex;"><span>protoc -I<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src --gogo_out<span style="color:#ff79c6">=</span>:. --vine_out<span style="color:#ff79c6">=</span>:. mysite/proto/greet.proto
</span></span></code></pre></div><p>æ‰§è¡ŒæˆåŠŸåä¼šç”Ÿæˆæ–°çš„æ–‡ä»¶:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mysite
</span></span><span style="display:flex;"><span>â””â”€â”€ proto
</span></span><span style="display:flex;"><span>    â”œâ”€â”€ greet.pb.go       <span style="color:#6272a4"># é€šè¿‡ protoc-gen-gogo æ’ä»¶ç”Ÿæˆï¼ŒåŒ…å«ç»“æ„ä½“å’Œ gRPC çš„æ¥å£</span>
</span></span><span style="display:flex;"><span>    â”œâ”€â”€ greet.pb.vine.go  <span style="color:#6272a4"># é€šè¿‡ protoc-gen-vine æ’ä»¶ç”Ÿæˆï¼ŒåŒ…å« Vine æ¡†æ¶æ¥å£</span>
</span></span><span style="display:flex;"><span>    â””â”€â”€ greet.proto
</span></span></code></pre></div><h2 id="å®šä¹‰æœåŠ¡">å®šä¹‰æœåŠ¡</h2>
<h3 id="å®ç°-vine-æœåŠ¡">å®ç° Vine æœåŠ¡</h3>
<p>æœ‰äº† proto æ–‡ä»¶åï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™æœåŠ¡ç«¯ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>mkdir -p server
</span></span><span style="display:flex;"><span>touch mysite/server/main.go
</span></span></code></pre></div><p>æœåŠ¡ç«¯ä»£ç :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;github.com/vine-io/vine&#34;</span>
</span></span><span style="display:flex;"><span>	pb <span style="color:#f1fa8c">&#34;mysite/proto&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// greet éœ€è¦å®ç° pb.Greet çš„æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">type</span> greet <span style="color:#8be9fd;font-style:italic">struct</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> (g <span style="color:#ff79c6">*</span>greet) <span style="color:#50fa7b">Echo</span>(ctx context.Context, req <span style="color:#ff79c6">*</span>pb.EchoReq, rsp <span style="color:#ff79c6">*</span>pb.EchoRsp) <span style="color:#8be9fd">error</span> {
</span></span><span style="display:flex;"><span>	rsp.Greeting = <span style="color:#f1fa8c">&#34;hello: &#34;</span> <span style="color:#ff79c6">+</span> req.Name
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> <span style="color:#ff79c6">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// æ„å»ºæ–°çš„æœåŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	app <span style="color:#ff79c6">:=</span> vine.<span style="color:#50fa7b">NewService</span>(
</span></span><span style="display:flex;"><span>		vine.<span style="color:#50fa7b">Name</span>(<span style="color:#f1fa8c">&#34;greet&#34;</span>),
</span></span><span style="display:flex;"><span>	)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// æœåŠ¡åˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	app.<span style="color:#50fa7b">Init</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// æ³¨å†ŒæœåŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	<span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">:=</span> pb.<span style="color:#50fa7b">RegisterGreeterHandler</span>(app.<span style="color:#50fa7b">Server</span>(), <span style="color:#ff79c6">&amp;</span>greet{}); err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span>		log.<span style="color:#50fa7b">Fatalf</span>(<span style="color:#f1fa8c">&#34;register greet hander: %v&#34;</span>, err)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// æœåŠ¡å¯åŠ¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	<span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">:=</span> app.<span style="color:#50fa7b">Run</span>(); err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span>		log.<span style="color:#50fa7b">Fatalf</span>(<span style="color:#f1fa8c">&#34;start greet server: %v&#34;</span>, err)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¿™æ ·ä¸€ä¸ªç®€æ˜“çš„ <strong>Vine</strong> æœåŠ¡å°±å®Œæˆäº†ã€‚</p>
<blockquote>
<p>æ›´å¤šæœåŠ¡ç«¯çš„å†…å®¹è¯·å‚è€ƒ <a href="/vine/docs/component/server/">å†…éƒ¨æœåŠ¡</a></p>
</blockquote>
<h3 id="å¯åŠ¨æœåŠ¡">å¯åŠ¨æœåŠ¡</h3>
<p>å¯åŠ¨æœåŠ¡å¹¶ç»‘å®šç«¯å£:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go run server/main.go
</span></span><span style="display:flex;"><span>2021-08-27 13:24:18  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>vine/service.go:171 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Starting <span style="color:#ff79c6">[</span>service<span style="color:#ff79c6">]</span> greet
</span></span><span style="display:flex;"><span>2021-08-27 13:24:18  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>vine/service.go:172 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info service <span style="color:#ff79c6">[</span>version<span style="color:#ff79c6">]</span> latest
</span></span><span style="display:flex;"><span>2021-08-27 13:24:18  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>grpc/grpc.go:920 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Server <span style="color:#ff79c6">[</span>grpc<span style="color:#ff79c6">]</span> Listening on <span style="color:#ff79c6">[</span>::<span style="color:#ff79c6">]</span>:65235
</span></span><span style="display:flex;"><span>2021-08-27 13:24:18  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>grpc/grpc.go:761 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Registry <span style="color:#ff79c6">[</span>mdns<span style="color:#ff79c6">]</span> Registering node: greet-d4d5e1a8-1bc0-4387-8fb2-1b5eda59055e
</span></span><span style="display:flex;"><span>2021-08-27 13:24:18  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>mdns/mdns_registry.go:266 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info <span style="color:#ff79c6">[</span>mdns<span style="color:#ff79c6">]</span> registry create new service with ip: 192.168.11.167 <span style="color:#ff79c6">for</span>: 192.168.11.167
</span></span></code></pre></div><p>å¦‚æœç”¨æˆ·æ²¡æœ‰æŒ‡å®š ip å’Œç«¯å£ï¼Œåˆ™é»˜è®¤ ip ä¸º 0.0.0.0ï¼Œç«¯å£éšæœºç”Ÿæˆã€‚</p>
<blockquote>
<p>å…³äº <strong>Vine</strong> æœåŠ¡çš„å‘½ä»¤è¡Œå‚æ•°å¯ä»¥å‚è€ƒ <a href="/vine/docs/component/cmd/">å‘½ä»¤è¡Œå‚æ•°</a></p>
</blockquote>
<h2 id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç¼–å†™å®¢æˆ·ç«¯çš„ä»£ç æ¥è¯·æ±‚æœåŠ¡ç«¯:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p client
</span></span><span style="display:flex;"><span>touch client/main.go
</span></span></code></pre></div><p>å®¢æˆ·ç«¯ä»£ç :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;github.com/vine-io/vine/core/client/grpc&#34;</span>
</span></span><span style="display:flex;"><span>	log <span style="color:#f1fa8c">&#34;github.com/vine-io/vine/lib/logger&#34;</span>
</span></span><span style="display:flex;"><span>	pb <span style="color:#f1fa8c">&#34;github.com/vine-io/vine/testdata/mysite/proto&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// é€‰æ‹© gRPC å®¢æˆ·ç«¯
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	cc <span style="color:#ff79c6">:=</span> grpc.<span style="color:#50fa7b">NewClient</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// æŒ‡å®šæœåŠ¡åç§°
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	client <span style="color:#ff79c6">:=</span> pb.<span style="color:#50fa7b">NewGreeterService</span>(<span style="color:#f1fa8c">&#34;greet&#34;</span>, cc)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#6272a4">// è¯·æ±‚ Greet.Echo æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>	rsp, err <span style="color:#ff79c6">:=</span> client.<span style="color:#50fa7b">Echo</span>(context.<span style="color:#50fa7b">TODO</span>(), <span style="color:#ff79c6">&amp;</span>pb.EchoReq{Name: <span style="color:#f1fa8c">&#34;lack&#34;</span>})
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span>		log.<span style="color:#50fa7b">Fatal</span>(err)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	log.<span style="color:#50fa7b">Infof</span>(<span style="color:#f1fa8c">&#34;greet result: %v&#34;</span>, rsp.Greeting)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ‰§è¡Œå‘½ä»¤è¾“å‡ºå¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go run client/main.go
</span></span><span style="display:flex;"><span>2021-08-27 13:24:41  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>client/main.go:20 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info greet result: hello: lack
</span></span></code></pre></div><blockquote>
<p>æ›´å¤šå…³äºå®¢æˆ·ç«¯çš„å†…å®¹å¯ä»¥å‚è€ƒ <a href="/vine/docs/component/client/">å†…éƒ¨è¯·æ±‚</a></p>
</blockquote>
<h2 id="api-æ¥å£">API æ¥å£</h2>
<p><strong>Vine</strong> æœåŠ¡å¯ä»¥åŒæ—¶æ”¯æŒ <code>gRPC</code> å’Œ <code>Restful</code> æ¥å£ã€‚</p>
<h3 id="ä¿®æ”¹-greetproto-æ–‡ä»¶">ä¿®æ”¹ greet.proto æ–‡ä»¶</h3>
<p>å…ˆä¿®æ”¹ greet.proto æ–‡ä»¶:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-protobuf" data-lang="protobuf"><span style="display:flex;"><span>syntax <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;proto3&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">package</span> greet;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// +gen:openapi
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">service</span> Greeter {
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4">// +gen:get=/api/v1/echo
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>  <span style="color:#ff79c6">rpc</span> Echo(EchoReq) <span style="color:#ff79c6">returns</span> (EchoRsp) {}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">message</span> <span style="color:#50fa7b">EchoReq</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">string</span> name <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">message</span> <span style="color:#50fa7b">EchoRsp</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd">string</span> greeting <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>é‡æ–°ç”Ÿæˆ <code>greet.pb.vine.go</code> æ–‡ä»¶:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>protoc -I<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src --vine_out<span style="color:#ff79c6">=</span>:.  github.com/vine-io/vine/testdata/mysite/proto/greet.proto
</span></span></code></pre></div><h3 id="å®‰è£…-vine">å®‰è£… <code>vine</code>:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/vine
</span></span></code></pre></div><h3 id="å¯åŠ¨ç½‘å…³">å¯åŠ¨ç½‘å…³</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine api --handler<span style="color:#ff79c6">=</span>rpc --enable-openapi  
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>openapi/openapi.go:56 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Starting OpenAPI at /openapi-ui/
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>api/api.go:179 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Registering API RPC Handler at /
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>http/http.go:116 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info HTTP API Listening on <span style="color:#ff79c6">[</span>::<span style="color:#ff79c6">]</span>:8080
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>vine/service.go:171 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Starting <span style="color:#ff79c6">[</span>service<span style="color:#ff79c6">]</span> go.vine.api
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>vine/service.go:172 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info service <span style="color:#ff79c6">[</span>version<span style="color:#ff79c6">]</span> latest
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>grpc/grpc.go:920 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Server <span style="color:#ff79c6">[</span>grpc<span style="color:#ff79c6">]</span> Listening on <span style="color:#ff79c6">[</span>::<span style="color:#ff79c6">]</span>:50405
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>grpc/grpc.go:761 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info Registry <span style="color:#ff79c6">[</span>mdns<span style="color:#ff79c6">]</span> Registering node: go.vine.api-b405ca1d-ba24-4470-a18e-b1feeb22c5f6
</span></span><span style="display:flex;"><span>2021-08-27 13:38:54  <span style="color:#8be9fd;font-style:italic">file</span><span style="color:#ff79c6">=</span>mdns/mdns_registry.go:266 <span style="color:#8be9fd;font-style:italic">level</span><span style="color:#ff79c6">=</span>info <span style="color:#ff79c6">[</span>mdns<span style="color:#ff79c6">]</span> registry create new service with ip: 192.168.11.167 <span style="color:#ff79c6">for</span>: 192.168.11.167
</span></span></code></pre></div><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éªŒè¯:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://127.0.0.1:8080/api/v1/echo<span style="color:#f1fa8c">\?</span>name<span style="color:#f1fa8c">\=</span>lack
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">{</span><span style="color:#f1fa8c">&#34;greeting&#34;</span>:<span style="color:#f1fa8c">&#34;hello: lack&#34;</span><span style="color:#ff79c6">}</span>%
</span></span></code></pre></div><p>å®Œæˆçš„ç›®å½•ç»“æ„å¦‚ä¸‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mysite
</span></span><span style="display:flex;"><span>â”œâ”€â”€ client
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.go
</span></span><span style="display:flex;"><span>â”œâ”€â”€ proto
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ greet.pb.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ greet.pb.vine.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ greet.proto
</span></span><span style="display:flex;"><span>â””â”€â”€ server
</span></span><span style="display:flex;"><span>    â””â”€â”€ main.go
</span></span></code></pre></div>
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2ca5b21c2e8606490b4d2c267c683e14">1 - æ¡†æ¶ç®€ä»‹</h1>
    
	<p><a href="https://opensource.org/licenses/Apache-2.0"><img src="https://img.shields.io/:license-apache-blue.svg" alt="License"></a> <a href="https://pkg.go.dev/github.com/vine-io/vine?tab=doc"><img src="https://img.shields.io/badge/go.dev-reference-007d9c?logo=go&amp;logoColor=white&amp;style=flat-square" alt="Go.Dev reference"></a> <a href="https://travis-ci.org/vine-io/vine"><img src="https://api.travis-ci.org/vine-io/vine.svg?branch=master" alt="Travis CI"></a> <a href="https://goreportcard.com/report/github.com/vine-io/vine"><img src="https://goreportcard.com/badge/vine-io/vine" alt="Go Report Card"></a></p>
<p>Vine (<em>/vaÉªn/</em>) ä¸€å¥—ç®€å•ã€é«˜æ•ˆã€å¯æ’æ‹”çš„åˆ†å¸ƒå¼ RPC æ¡†æ¶ã€‚</p>
<blockquote>
<p>Vine (è‘¡è„æ ‘ ğŸ‡) : æˆ‘ä»¬å¸Œæœ›å®ƒèƒ½åƒçš„å®ƒåå­—ä¸€æ ·ï¼Œå¤šèŠ‚æœå­ã€‚</p>
</blockquote>
<h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p><strong>Vine</strong> åŸºäº <a href="https://github.com/asim/go-micro">go-micro</a> æ¡†æ¶ï¼Œå› æ­¤ç»§æ‰¿äº†å®ƒçš„ä¼˜ç‚¹ã€‚å¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œè£å‰ªå’Œæ”¹è¿›ï¼Œå¢åŠ æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚</p>
<h2 id="æ¶æ„å›¾">æ¶æ„å›¾</h2>
<p><img src="vine%E6%9E%B6%E6%9E%84%E5%9B%BE.png" alt="vineæ¶æ„å›¾"></p>
<h2 id="åŠŸèƒ½">åŠŸèƒ½</h2>
<p><strong>Vine</strong> æŠ½è±¡åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„å†…éƒ¨ç»†èŠ‚. ä»¥ä¸‹æ˜¯ä¸»è¦åŠŸèƒ½.</p>
<ul>
<li>
<p><strong>åŠ¨æ€é…ç½® (Dynamic Config)</strong> - ä»ä»»æ„åœ°æ–¹åŠ è½½å’Œçƒ­åŠ è½½åŠ¨æ€é…ç½®ã€‚é…ç½®æ¥å£æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥ä»ä»»ä½•æºï¼ˆå¦‚ç¯å¢ƒå˜é‡ï¼Œæ–‡ä»¶ï¼Œetcdï¼‰åŠ è½½åº”ç”¨çº§åˆ«é…ç½®ã€‚åŒæ—¶æ”¯æŒåˆå¹¶æºã€ç”šè‡³å®šä¹‰å›é€€ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®å­˜å‚¨ (Dao)</strong> - ä¸€ä¸ªç®€å•çš„æ•°æ®å­˜å‚¨æ¥å£ï¼Œç”¨äºæŸ¥è¯¢ï¼Œåˆ›å»ºï¼Œåˆ é™¤æ•°æ®è®°å½•ã€‚å†…ç½® memoryï¼Œfileï¼ŒpostgresSQL ç­‰</p>
</li>
<li>
<p><strong>ç¼“å­˜æ¥å£ (Cache)</strong> - æ”¯æŒå†…éƒ¨æ•°æ®ç¼“å­˜ï¼Œä¿å­˜ä¸´æ—¶æ•°æ®ã€‚</p>
</li>
<li>
<p><strong>æœåŠ¡å‘ç° (Service discovery)</strong> - è‡ªåŠ¨æœåŠ¡æ³¨å†Œå’Œåç§°è§£æã€‚æœåŠ¡å‘ç°æ˜¯å¾®æœåŠ¡å¼€å‘çš„æ ¸å¿ƒåŠŸèƒ½ã€‚å½“æœåŠ¡Aä¸æœåŠ¡Bé€šè®¯æ—¶ï¼Œéœ€è¦çŸ¥é“æœåŠ¡Bçš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚<strong>Vine</strong> å†…ç½®(mdns)ä½œä¸ºæœåŠ¡å‘ç°ç»„ä»¶ï¼Œå®ƒæ˜¯é›¶é…ç½®ç³»ç»Ÿã€‚</p>
</li>
<li>
<p><strong>è´Ÿè½½å‡è¡¡ (Load Balancing)</strong> - åŸºäºæœåŠ¡å‘ç°çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€‚å½“å†…éƒ¨å­˜åœ¨å¤šä¸ªæœåŠ¡å®ä¾‹çš„åœ°å€æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹å¼ç¡®å®šè·¯ç”±åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼Œé»˜è®¤ä½¿ç”¨éšæœºæŒ‡å®šå…¶ä¸­ä¸€ä¸ªåœ°å€ã€‚åŒæ—¶åœ¨è¯·æ±‚é”™è¯¯æ—¶é‡è¯•ä¸åŒçš„èŠ‚ç‚¹ã€‚</p>
</li>
<li>
<p><strong>æ¶ˆæ¯ç¼–ç  (Message Encoding)</strong> - åŸºäº<code>Content-Type</code>çš„åŠ¨æ€æ¶ˆæ¯ç¼–ç ã€‚Codec ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æä¾› Go ç±»å‹çš„ç¼–ç å’Œè§£ç ï¼Œæ”¯æŒå„ç§ä¸åŒçš„ç±»å‹ã€‚é»˜è®¤ä½¿ç”¨ protobuf å’Œ jsonã€‚</p>
</li>
<li>
<p><strong>gRPC ä¼ è¾“ (gRPC transport)</strong> - åŸºäº gRPC çš„è¯·æ±‚å“åº”ï¼ŒåŒæ—¶æ”¯æŒåŒå‘æµã€‚<strong>Vine</strong> ä¸ºåŒæ­¥é€šè®¯æä¾›ä¸€ä¸ªæŠ½è±¡ï¼Œä½¿å‘å‘æœåŠ¡çš„è¯·æ±‚è¢«è‡ªåŠ¨è§£æã€è´Ÿè½½å‡è¡¡ã€æ‹¨å·å’ŒæµåŒ–ã€‚</p>
</li>
<li>
<p><strong>å¼‚æ­¥æ¶ˆæ¯ (Async Messaging)</strong> - å†…ç½®è®¢é˜…å‘å¸ƒæ¨¡å‹ï¼Œä½œä¸ºå¼‚æ­¥é€šè®¯å’Œäº‹ä»¶é©±åŠ¨æ¶æ„ã€‚äº‹ä»¶é€šçŸ¥å±äºå¾®æœåŠ¡å¼€å‘ä¸­çš„æ ¸å¿ƒæ¨¡å¼ã€‚é»˜è®¤çš„æ¶ˆæ¯ç³»ç»Ÿä¸º HTTP äº‹ä»¶ä»£ç†ã€‚</p>
</li>
<li>
<p><strong>åŒæ­¥ (Synchronization)</strong> - åˆ†å¸ƒå¼ç³»ç»Ÿé€šå¸¸ä»¥æœ€ç»ˆä¸€è‡´æ€§çš„æ–¹å¼æ„å»ºã€‚å†…ç½®çš„ <strong>Sync</strong> æ¥å£å®ç°åˆ†å¸ƒå¼é”å’Œé¢†å¯¼é€‰ä¸¾ã€‚</p>
</li>
<li>
<p><strong>å¯æ’æ‹”æ¥å£ (Pluggable Interfaces)</strong> - å¾—ç›Šäº Go è¯­è¨€çš„æŠ½è±¡ç‰¹æ€§ã€‚ <strong>Vine</strong> ä¸ºæ¯ä¸ªæ¨¡å—æä¾›æŠ½è±¡æ¥å£ï¼Œæ­£å› ä¸ºå¦‚æ­¤ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¯æ’æ‹”çš„ã€‚å¯ä»¥åœ¨ <a href="https://github.com/vine-io/plugins">github.com/vine-io/plugins</a> æŸ¥è¯¢ä½ éœ€è¦çš„æ’ä»¶ã€‚</p>
</li>
</ul>
<h2 id="è®¸å¯">è®¸å¯</h2>
<p>Vine éµå®ˆ MIT License å¼€æºè®¸å¯.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-83087925151d27e6b8d84f40aff9cdee">2 - æ–°å»ºé¡¹ç›®</h1>
    
	<h2 id="ä¾èµ–">ä¾èµ–</h2>
<p>æ–°å»º <strong>Vine</strong> é¡¹ç›®éœ€è¦å®‰è£…ä¾èµ–ç¯å¢ƒå’Œå·¥å…·:</p>
<ul>
<li><a href="https://golang.org/dl/">go</a></li>
<li><a href="https://github.com/protocolbuffers/protobuf">protoc</a></li>
</ul>
<p>å»ºè®®å¼€å¯GO111MODULE</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go env -w <span style="color:#8be9fd;font-style:italic">GO111MODULE</span><span style="color:#ff79c6">=</span>on
</span></span></code></pre></div><h2 id="å®‰è£…">å®‰è£…</h2>
<p>å®‰è£… <strong>Vine</strong> å·¥å…·</p>
<p>go get å®‰è£…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go get -u github.com/vine-io/vine/cmd/vine@latest
</span></span><span style="display:flex;"><span>go get -u github.com/vine-io/vine/cmd/protoc-gen-gogo@latest
</span></span><span style="display:flex;"><span>go get -u github.com/vine-io/vine/cmd/protoc-gen-vine@latest
</span></span></code></pre></div><p>go install å®‰è£…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go install github.com/vine-io/vine/cmd/vine@latest
</span></span><span style="display:flex;"><span>go install github.com/vine-io/vine/cmd/protoc-gen-gogo@latest
</span></span><span style="display:flex;"><span>go install github.com/vine-io/vine/cmd/protoc-gen-vine@latest
</span></span></code></pre></div><p>æºç ç¼–è¯‘å®‰è£…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/vine-io/vine
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> vine
</span></span><span style="display:flex;"><span>make build <span style="color:#ff79c6">&amp;&amp;</span> mv vine <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/bin/vine 
</span></span></code></pre></div><h2 id="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># æ–°å»ºé¡¹ç›®æ ¹ç›®å½•</span>
</span></span><span style="display:flex;"><span>mkdir -p <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/helloworld
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/helloworld
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># åˆå§‹åŒ–ç›®å½•</span>
</span></span><span style="display:flex;"><span>vine init
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># æ–°å»ºæœåŠ¡</span>
</span></span><span style="display:flex;"><span>vine new service helloworld
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># ç”Ÿæˆä»£ç </span>
</span></span><span style="display:flex;"><span>vine build proto
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># å®‰è£…ä¾èµ–</span>
</span></span><span style="display:flex;"><span>go mod vendor
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># å¯åŠ¨æœåŠ¡</span>
</span></span><span style="display:flex;"><span>vine run helloworld
</span></span></code></pre></div><h2 id="å¯åŠ¨æœåŠ¡">å¯åŠ¨æœåŠ¡</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine run helloworld
</span></span></code></pre></div><h2 id="å¯åŠ¨ç½‘å…³">å¯åŠ¨ç½‘å…³</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine api --handler<span style="color:#ff79c6">=</span>rpc --enable-openapi
</span></span></code></pre></div><h2 id="æµ‹è¯•">æµ‹è¯•</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://127.0.0.1:8080/foo/v1/foo/Call -H <span style="color:#f1fa8c">&#34;Content-Type: application/json&#34;</span>  -d <span style="color:#f1fa8c">&#34;{\&#34;name\&#34;:\&#34;World\&#34;}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># {&#34;msg&#34;:&#34;reply: World&#34;}</span>
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-67790003301156bb2bbfd3d432c5d2f6">3 - é¡¹ç›®ç»“æ„</h1>
    
	<p><strong>Vine</strong> æä¾›å‘½ä»¤è¡Œå·¥å…·åˆ›å»ºé¡¹ç›®ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦çš„å·¥å…·é“¾å’Œéƒ¨ç½²å†…å®¹ã€‚ç¬¦åˆ DDD è®¾è®¡è§„èŒƒã€‚</p>
<h2 id="å•æœåŠ¡">å•æœåŠ¡</h2>
<p>å•æœåŠ¡ç›®å½•ç»“æ„ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»º:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir <span style="color:#8be9fd;font-style:italic">$PATH</span>/src/foo
</span></span><span style="display:flex;"><span>vine init
</span></span><span style="display:flex;"><span>vine new service foo
</span></span></code></pre></div><p>ç”Ÿæˆç›®å½•ç»“æ„:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>â”œâ”€â”€ Makefile
</span></span><span style="display:flex;"><span>â”œâ”€â”€ README.md
</span></span><span style="display:flex;"><span>â”œâ”€â”€ api  // ------ ç»´æŠ¤ grpc æ¥å£ï¼Œå’Œ domain å±‚ä¸­é¢†åŸŸæ¨¡å‹
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ service
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ foo
</span></span><span style="display:flex;"><span>â”‚Â Â          â””â”€â”€ v1
</span></span><span style="display:flex;"><span>â”‚Â Â              â”œâ”€â”€ foo.pb.go
</span></span><span style="display:flex;"><span>â”‚Â Â              â”œâ”€â”€ foo.pb.validator.go
</span></span><span style="display:flex;"><span>â”‚Â Â              â”œâ”€â”€ foo.pb.vine.go
</span></span><span style="display:flex;"><span>â”‚Â Â              â””â”€â”€ foo.proto
</span></span><span style="display:flex;"><span>â”œâ”€â”€ cmd         // ------ é¡¹ç›®å…¥å£
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.go
</span></span><span style="display:flex;"><span>â”œâ”€â”€ deploy    // ------- éƒ¨ç½²ç›¸å…³å·¥å…·
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ Dockerfile
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ foo.ini
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ foo.service
</span></span><span style="display:flex;"><span>â”œâ”€â”€ go.mod
</span></span><span style="display:flex;"><span>â”œâ”€â”€ go.sum
</span></span><span style="display:flex;"><span>â”œâ”€â”€ pkg  // æœåŠ¡å†…éƒ¨ä»£ç 
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ app.go  // -------- æ„é€ å’Œç»„åˆå„å±‚ä»£ç ï¼Œæä¾›ç»™ cmd/main.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ biz  // ---------- DDD çš„ domain å±‚ï¼Œç»´æŠ¤ä¸šåŠ¡ä»£ç 
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ foo.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ infra  // --------- DDD çš„ infrastructure å±‚ï¼Œåº•å±‚é€šç”¨ä»£ç 
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cache  // -------- ç¼“å­˜ç›¸å…³
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ cache.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ storage  // ------- æ•°æ®åº“ storageï¼Œæ•°æ®äº¤äº’
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â      â””â”€â”€ storage.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ service   // ---------- DDD çš„ interfaces å±‚ï¼Œæä¾›å¯¹å¤–çš„ gRPC æ¥å£ 
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ foo.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ internal
</span></span><span style="display:flex;"><span>â””â”€â”€ vine.toml   // -------- vine é¡¹ç›®çš„æè¿°æ–‡ä»¶
</span></span></code></pre></div><h2 id="å¤šæœåŠ¡">å¤šæœåŠ¡</h2>
<p>å½“ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰å¤šä¸ªå¾®æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬æ¨èä»£ç åœ¨ä¸€ä¸ªç›®å½•ä¸­ç»´æŠ¤ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»º</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/cluster
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/cluster
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vine init --cluster
</span></span><span style="display:flex;"><span>vine new service helloworld
</span></span></code></pre></div><p>ç”Ÿæˆä»¥ä¸‹ç›®å½•ç»“æ„:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>â”œâ”€â”€ Makefile
</span></span><span style="display:flex;"><span>â”œâ”€â”€ README.md
</span></span><span style="display:flex;"><span>â”œâ”€â”€ api
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ service
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ helloworld
</span></span><span style="display:flex;"><span>â”‚Â Â          â””â”€â”€ v1
</span></span><span style="display:flex;"><span>â”‚Â Â              â””â”€â”€ helloworld.proto
</span></span><span style="display:flex;"><span>â”œâ”€â”€ cmd
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ helloworld
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ main.go
</span></span><span style="display:flex;"><span>â”œâ”€â”€ deploy
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ config
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ helloworld.ini
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ docker
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ helloworld
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â      â””â”€â”€ Dockerfile
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ systemd
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ helloworld.service
</span></span><span style="display:flex;"><span>â”œâ”€â”€ go.mod
</span></span><span style="display:flex;"><span>â”œâ”€â”€ pkg   
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ helloworld // -------- å¤šæœåŠ¡æ˜¯ï¼Œpkg æ¯ä¸ªç›®å½•ä»£ç ä¸€ä¸ªæœåŠ¡
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ biz
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ helloworld.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ infra
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cache
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ cache.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ storage
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ storage.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ service
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â      â””â”€â”€ helloworld.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ internal  // ------ å¤šä¸ªæœåŠ¡é—´çš„é€šç”¨ä»£ç 
</span></span><span style="display:flex;"><span>â””â”€â”€ vine.toml
</span></span></code></pre></div><h2 id="vinetoml">vine.toml</h2>
<p><code>vine.toml</code> æ˜¯ <strong>Vine</strong> é¡¹ç›®çš„æè¿°æ–‡ä»¶ï¼Œå½“ä¸€ä¸ªç›®å½•åº•ä¸‹å­˜åœ¨è¯¥æ–‡ä»¶æ—¶ï¼Œä¼šè¢«è¯†åˆ«ä¸º <strong>Vine</strong> é¡¹ç›®ã€‚</p>
<p><code>vine.toml</code> å­˜åœ¨ä¸¤ç§æ ¼å¼ï¼Œsingle å’Œ clusterã€‚</p>
<h3 id="single">single</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span>package<span style="color:#ff79c6">]</span>               <span style="color:#6272a4"># [package] æè¿°é¡¹ç›®çš„å…¬å…±ä¿¡æ¯ </span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">kind</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;single&#34;</span>         <span style="color:#6272a4"># é¡¹ç›®ç±»å‹ single å’Œ cluster</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">namespace</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;go.vine&#34;</span>   <span style="color:#6272a4"># ç»Ÿä¸€çš„å‘½åç©ºé—´</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>pkg<span style="color:#ff79c6">]</span>      <span style="color:#6272a4"># single é¡¹ç›®è¯¦ç»†ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">name</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;foo&#34;</span>  <span style="color:#6272a4"># é¡¹ç›®åç§°</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">alias</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;go.vine.service.foo&#34;</span> <span style="color:#6272a4"># æœåŠ¡åç§°</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;service&#34;</span>    <span style="color:#6272a4"># æœåŠ¡ç±»å‹ service, gateway</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">version</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;latest&#34;</span>  <span style="color:#6272a4"># æœåŠ¡ç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">main</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;cmd/main.go&#34;</span> <span style="color:#6272a4"># æœåŠ¡å…¥å£æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">dir</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;github.com/lack-io/foo&#34;</span>  <span style="color:#6272a4"># æœåŠ¡æ ¸å¿ƒä»£ç ç›®å½•</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">output</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>  <span style="color:#6272a4"># ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶çš„å­˜æ”¾ç›®å½•</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">flags</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;-a&#34;</span>, <span style="color:#f1fa8c">&#34;-installsuffix&#34;</span>, <span style="color:#f1fa8c">&#34;cgo&#34;</span>, <span style="color:#f1fa8c">&#34;-ldflags \&#34;-s -w\&#34;&#34;</span>,  <span style="color:#6272a4"># ç¼–è¯‘å‚æ•°, æ”¯æŒshellå‘½ä»¤ä½œä¸ºå€¼ &#34;name=$(echo hello)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[[</span>proto<span style="color:#ff79c6">]]</span>    <span style="color:#6272a4"># *.proto æ–‡ä»¶ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">name</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;foo&#34;</span> <span style="color:#6272a4"># proto æ–‡ä»¶åç§°</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">pb</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;github.com/lack-io/foo/api/service/foo/v1/foo.proto&#34;</span> <span style="color:#6272a4"># proto æ–‡ä»¶è·¯å¾„</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;service&#34;</span> <span style="color:#6272a4"># proto ç±»å‹ service å’Œ apiï¼› service è¡¨ç¤º gRPC æœåŠ¡ï¼Œapi è¡¨ç¤ºé¢†åŸŸæ¨¡å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">group</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;foo&#34;</span> <span style="color:#6272a4"># proto åˆ†ç»„</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">version</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;v1&#34;</span> <span style="color:#6272a4"># proto ç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">plugins</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;gogo&#34;</span>, <span style="color:#f1fa8c">&#34;vine&#34;</span>, <span style="color:#f1fa8c">&#34;validator&#34;</span><span style="color:#ff79c6">]</span> <span style="color:#6272a4"># æ‰§è¡Œ protoc å‘½ä»¤æ—¶æºå¸¦çš„æ’ä»¶ï¼Œå¯é€‰ gogoã€vineã€validatorã€deepcopyã€dao</span>
</span></span></code></pre></div><h3 id="cluster">cluster</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span>package<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">kind</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;cluster&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">namespace</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;go.vine&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[[</span>mod<span style="color:#ff79c6">]]</span>  <span style="color:#6272a4"># æ¯ä¸ª mod è¡¨ç¤ºä¸€ä¸ªæœåŠ¡</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">name</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;helloworld&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">alias</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;go.vine.service.helloworld&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;service&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">version</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;latest&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">main</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;cmd/helloworld/main.go&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">dir</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;github.com/lack-io/foo/helloworld&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">output</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">flags</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;-a&#34;</span>, <span style="color:#f1fa8c">&#34;-installsuffix&#34;</span>, <span style="color:#f1fa8c">&#34;cgo&#34;</span>, <span style="color:#f1fa8c">&#34;-ldflags \&#34;-s -w\&#34;&#34;</span>, 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[[</span>proto<span style="color:#ff79c6">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">name</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;helloworld&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">pb</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;github.com/lack-io/foo/api/service/helloworld/v1/helloworld.proto&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;service&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">group</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;helloworld&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">version</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;v1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">plugins</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span><span style="color:#f1fa8c">&#34;gogo&#34;</span>, <span style="color:#f1fa8c">&#34;vine&#34;</span>, <span style="color:#f1fa8c">&#34;validator&#34;</span><span style="color:#ff79c6">]</span>
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-79e475706ae8025baf8c0f923eec34bd">4 - æ„å»ºå·¥å…·</h1>
    
	<p>æˆ‘ä»¬æä¾›ä¸€å¥—å·¥å…·å¸®åŠ©å¼€å‘è€…å¿«é€Ÿæ„å»ºå¾®æœåŠ¡ã€‚</p>
<h2 id="å®‰è£…">å®‰è£…</h2>
<p>ä½¿ç”¨ go get å®‰è£…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go get -u github.com/vine-io/vine/cmd/vine@latest
</span></span></code></pre></div><p>ç¼–è¯‘åŒ…å®‰è£… (æ¨è)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget https://github.com/vine-io/vine/releases/download/v0.23.0/vine-darwin-amd64-v0.23.0.tar.gz
</span></span><span style="display:flex;"><span>tar -xvf vine-darwin-amd64-v0.23.0.tar.gz
</span></span><span style="display:flex;"><span>cp -r darwin-amd64/* <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/bin/
</span></span></code></pre></div><p>å·¥å…·ä½¿ç”¨</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine --version
</span></span><span style="display:flex;"><span>&gt; v0.23.0-8b25f36c-1630374346
</span></span></code></pre></div><h2 id="æ–°å»ºé¡¹ç›®">æ–°å»ºé¡¹ç›®</h2>
<p>åˆ›å»ºç›®å½•ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/foo
</span></span></code></pre></div><p>åˆå§‹åŒ–ç›®å½•</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> <span style="color:#8be9fd;font-style:italic">$GOPATH</span>/src/foo
</span></span><span style="display:flex;"><span>vine init
</span></span></code></pre></div><p><code>vine init [--cluster]</code> ä¼šåˆå§‹åŒ– <strong>Vine</strong> é¡¹ç›®ï¼Œç”Ÿæˆä»¥ä¸‹æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>â”œâ”€â”€ vine.toml  <span style="color:#6272a4"># vine é¡¹ç›®çš„æè¿°æ–‡ä»¶ï¼ŒåŒ…æ‹¬é¡¹ç›®åç§°ï¼ŒæœåŠ¡æ¥å£å’Œprotoç­‰ä¿¡æ¯ã€‚</span>
</span></span><span style="display:flex;"><span>â”œâ”€â”€ README.md
</span></span><span style="display:flex;"><span>â”œâ”€â”€ .gitignore
</span></span><span style="display:flex;"><span>â””â”€â”€ go.mod
</span></span></code></pre></div><h2 id="æ–°å»ºæœåŠ¡">æ–°å»ºæœåŠ¡</h2>
<p>åœ¨åˆå§‹åŒ–çš„ç›®å½•æ–°å»ºå¾®æœåŠ¡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine new service foo
</span></span></code></pre></div><blockquote>
<p>vine é¡¹ç›®ç±»å‹ä¸º single æ—¶ï¼Œ<code>vine new service</code> æŒ‡å®šæœåŠ¡åç§°æ˜¯æ— æ•ˆçš„ï¼Œå®ƒçš„åç§°ç­‰äºç›®å½•åã€‚</p>
</blockquote>
<p>æ‰§è¡Œç»“æœï¼Œç”Ÿæˆä»¥ä¸‹æ–‡æ¡£:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>â”œâ”€â”€ cmd
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ main.go
</span></span><span style="display:flex;"><span>â”œâ”€â”€ pkg
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ runtime
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ doc.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ inject
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â      â””â”€â”€ inject.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ app.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ interfaces
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ foo.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ app
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ foo.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ biz
</span></span><span style="display:flex;"><span>â”‚Â Â  â”‚Â Â  â””â”€â”€ foo.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ infra
</span></span><span style="display:flex;"><span>â”‚Â Â      â”œâ”€â”€ storage
</span></span><span style="display:flex;"><span>â”‚Â Â      â”‚Â Â  â””â”€â”€ storage.go
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ cache
</span></span><span style="display:flex;"><span>â”‚Â Â          â””â”€â”€ cache.go
</span></span><span style="display:flex;"><span>â”œâ”€â”€ deploy
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ Dockerfile
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ foo.ini
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ foo.service
</span></span><span style="display:flex;"><span>â”œâ”€â”€ api
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ service
</span></span><span style="display:flex;"><span>â”‚Â Â      â””â”€â”€ foo
</span></span><span style="display:flex;"><span>â”‚Â Â          â””â”€â”€ v1
</span></span><span style="display:flex;"><span>â”‚Â Â              â””â”€â”€ foo.proto
</span></span><span style="display:flex;"><span>â”œâ”€â”€ Makefile
</span></span><span style="display:flex;"><span>â””â”€â”€ vine.toml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>download protoc zip packages <span style="color:#ff79c6">(</span>protoc-<span style="color:#8be9fd;font-style:italic">$VERSION</span>-<span style="color:#8be9fd;font-style:italic">$PLATFORM</span>.zip<span style="color:#ff79c6">)</span> and install:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>visit https://github.com/protocolbuffers/protobuf/releases
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>download protobuf <span style="color:#ff79c6">for</span> vine:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> github.com/lack-io/foo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>install dependencies:
</span></span><span style="display:flex;"><span>        go get github.com/gogo/protobuf
</span></span><span style="display:flex;"><span>        go get github.com/vine-io/vine/cmd/protoc-gen-gogo
</span></span><span style="display:flex;"><span>        go get github.com/vine-io/vine/cmd/protoc-gen-vine
</span></span><span style="display:flex;"><span>        go get github.com/vine-io/vine/cmd/protoc-gen-validator
</span></span><span style="display:flex;"><span>        go get github.com/vine-io/vine/cmd/protoc-gen-deepcopy
</span></span><span style="display:flex;"><span>        go get github.com/vine-io/vine/cmd/protoc-gen-dao
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> github.com/lack-io/foo
</span></span><span style="display:flex;"><span>        vine build foo
</span></span></code></pre></div><h2 id="å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go get github.com/gogo/protobuf
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-gogo
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-vine
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-validator
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-deepcopy
</span></span><span style="display:flex;"><span>go get github.com/vine-io/vine/cmd/protoc-gen-dao
</span></span></code></pre></div><h2 id="æ›´åŠ -proto-æ–‡ä»¶ç”Ÿæˆ-go-ä»£ç ">æ›´åŠ  proto æ–‡ä»¶ç”Ÿæˆ go ä»£ç </h2>
<p>ä½¿ç”¨å‘½ä»¤æ ¼å¼ä¸º: <code>vine build proto [command options] [proto_name]</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># ç”Ÿæˆ vine.toml ä¸­æ‰€æœ‰ proto æ–‡ä»¶å¯¹åº”çš„ä»£ç ã€‚</span>
</span></span><span style="display:flex;"><span>vine new proto
</span></span></code></pre></div><p>æ”¯æŒå¦‚ä¸‹å‚æ•°:</p>
<ul>
<li>&ndash;type string                      æŒ‡å®š proto æ–‡ä»¶çš„ç±»å‹ï¼Œæ”¯æŒ api å’Œ serviceï¼Œé»˜è®¤ api</li>
<li>&ndash;proto-version string, -v string  æŒ‡å®š proto æ–‡ä»¶ç‰ˆæœ¬ï¼Œé»˜è®¤ v1</li>
<li>&ndash;group string                     æŒ‡å®š proto æ–‡ä»¶åˆ†ç»„ï¼Œé»˜è®¤ core</li>
<li>&ndash;dir string                       æ‰§è¡Œ protoc å‘½ä»¤æ˜¯æ‰€åœ¨çš„ç›®å½•ï¼Œchroot</li>
<li>&ndash;path strings, -I strings         protoc -I è·¯å¾„</li>
<li>&ndash;plugins strings, -P strings      ç”Ÿæˆ proto æ—¶è£…è½½çš„æ’ä»¶</li>
</ul>
<h2 id="è¿è¡ŒæœåŠ¡">è¿è¡ŒæœåŠ¡</h2>
<p>å‘½ä»¤æ ¼å¼: <code>vine new [command options] [name]</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine run foo
</span></span></code></pre></div><p>æ”¯æŒå¦‚ä¸‹å‚æ•°:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>- --auto-restart                    ç›‘å¬æ–‡ä»¶å˜åŒ–æ—¶é‡å¯æœåŠ¡
</span></span><span style="display:flex;"><span>- --watch strings                   è¿½åŠ ç›‘å¬çš„è·¯å¾„
</span></span><span style="display:flex;"><span>- --watch-interval int64, -I int64  ç›‘å¬äº‹ä»¶è§¦å‘é—´éš”ï¼Œé»˜è®¤3s
</span></span></code></pre></div><h2 id="å¯åŠ¨-api-ç½‘å…³">å¯åŠ¨ api ç½‘å…³</h2>
<p>å‘½ä»¤æ ¼å¼: <code>vine api [command options]</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vine api --handler<span style="color:#ff79c6">=</span>rpc --enable-openapi
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1adf2527acb4bd9f3ca351337ddc8408">5 - å¯é€‰å‚æ•°</h1>
    
	<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2>
<p>åˆ›å»ºæ–°æœåŠ¡æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©ä¼ é€’å…¶ä»–å‚æ•°ï¼Œä¾‹å¦‚è®¾ç½®åç§°ï¼Œç‰ˆæœ¬ï¼ŒBrokerï¼ŒRegistry æˆ–è€…å­˜å‚¨ï¼Œä»¥ä¾¿ä¸æ‰€æœ‰å…¶ä»–å†…éƒ¨å®ç°ä¸€èµ·ä½¿ç”¨ã€‚
é€‰é¡¹é€šå¸¸å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> Options <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    Name        <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    Version     <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    Broker      broker.Broker
</span></span><span style="display:flex;"><span>    Registry    registry.Registry
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> Option <span style="color:#8be9fd;font-style:italic">func</span>(<span style="color:#ff79c6">*</span>Options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// set the name
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">Name</span>(n <span style="color:#8be9fd">string</span>) Option {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">func</span>(o <span style="color:#ff79c6">*</span>Options) {
</span></span><span style="display:flex;"><span>        o.Name = n
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// set the broker
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">Broker</span>(b broker.Broker) Option {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">func</span>(o <span style="color:#ff79c6">*</span>Options) {
</span></span><span style="display:flex;"><span>        o.Broker = b
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç„¶åè¿™å®‰è£…å¦‚ä¸‹æ–¹å¼è®¾ç½®è¿™äº›é€‰é¡¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>service <span style="color:#ff79c6">:=</span> vine.<span style="color:#50fa7b">NewService</span>(
</span></span><span style="display:flex;"><span>    vine.<span style="color:#50fa7b">Name</span>(<span style="color:#f1fa8c">&#34;foobar&#34;</span>),
</span></span><span style="display:flex;"><span>    vine.<span style="color:#50fa7b">Broker</span>(broker),
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h2 id="æœåŠ¡-options">æœåŠ¡ options</h2>
<p>åœ¨ <strong>Vine</strong> ä¸­ï¼Œæˆ‘ä»¬æœ‰å¯ä»¥è®¾ç½®å¤šç§é€‰é¡¹ï¼ŒåŒ…æ‹¬ç”¨äºèº«ä»½éªŒè¯ï¼Œé…ç½®å’Œå­˜å‚¨ç­‰å†…å®¹çš„åŸºç¡€åŒ…ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>service.Options()</code> æ¥è®¿é—®è¿™äº›ã€‚</p>
<p>authã€configã€registryã€cache ç­‰åŒ…å°†é»˜è®¤ä¸ºæˆ‘ä»¬çš„é›¶ä¾èµ–æ’ä»¶ã€‚å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æˆ–è€…å‘½ä»¤è¡Œå‚æ•°æ¥é…ç½®å®ƒä»¬ï¼Œåœ¨æ‰§è¡Œ <code>service.Init()</code> åç”Ÿæ•ˆã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4">## as an env vars</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">VINE_CACHE</span><span style="color:#ff79c6">=</span>file go run main.go
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">## or as a flag</span>
</span></span><span style="display:flex;"><span>go run main.go --cache<span style="color:#ff79c6">=</span>file
</span></span></code></pre></div><h2 id="ä½¿ç”¨-options">ä½¿ç”¨ options</h2>
<p>åœ¨å†…éƒ¨ï¼Œå¯ä»¥é€šè¿‡é€‰é¡¹è®¿é—®å­˜å‚¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>service <span style="color:#ff79c6">:=</span> vine.<span style="color:#50fa7b">NewService</span>(
</span></span><span style="display:flex;"><span>    vine.<span style="color:#50fa7b">Name</span>(<span style="color:#f1fa8c">&#34;foobar&#34;</span>),
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>service.<span style="color:#50fa7b">Init</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>store <span style="color:#ff79c6">:=</span> service.<span style="color:#50fa7b">Options</span>().Store
</span></span></code></pre></div><blockquote>
<p><strong>Vine</strong> æ¯ä¸ªå†…éƒ¨æ¥å£ä¸€èˆ¬éƒ½æœ‰å¯¹åº”çš„é€‰é¡¹ï¼Œåœ¨æ’ä»¶ä¸­ï¼Œé¢å¤–çš„é€‰é¡¹é€šå¸¸è¢«ä¿å­˜åœ¨ <code>context.Context</code> ä¸­ã€‚</p>
</blockquote>
<h2 id="è‡ªå®šä¹‰-options">è‡ªå®šä¹‰ options</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>custom <span style="color:#ff79c6">:=</span> <span style="color:#8be9fd;font-style:italic">func</span>(s <span style="color:#8be9fd">string</span>) vine.Option {
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> <span style="color:#8be9fd;font-style:italic">func</span>(o <span style="color:#ff79c6">*</span>vine.Options) {
</span></span><span style="display:flex;"><span>		o.Context = context.<span style="color:#50fa7b">WithValue</span>(o.Context, s, s)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>vine.<span style="color:#50fa7b">NewService</span>(<span style="color:#50fa7b">custom</span>(<span style="color:#f1fa8c">&#34;value&#34;</span>))
</span></span></code></pre></div><h2 id="æ‰€æœ‰-options">æ‰€æœ‰ options</h2>
<p>vine æœåŠ¡åˆå§‹åŒ–æ˜¯ï¼Œæ”¯æŒä»¥ä¸‹ options</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>vine.<span style="color:#50fa7b">Name</span>(),            <span style="color:#6272a4">// å¾®æœåŠ¡åç§°
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Id</span>(),              <span style="color:#6272a4">// å¾®æœåŠ¡ uuid
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Version</span>(),         <span style="color:#6272a4">// å¾®æœåŠ¡ç‰ˆæœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Address</span>(),         <span style="color:#6272a4">// å¾®æœåŠ¡ç»‘å®šåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Metadata</span>(),        <span style="color:#6272a4">// å¾®æœåŠ¡ metadata
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Server</span>(),          <span style="color:#6272a4">// è®¾ç½®å†…éƒ¨ Server æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Client</span>(),          <span style="color:#6272a4">// è®¾ç½®å†…éƒ¨ Client æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Selector</span>(),        <span style="color:#6272a4">// è®¾ç½® client selector 
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">HandleSignal</span>(),    <span style="color:#6272a4">// æ˜¯å¦å¤„ç†ç³»ç»Ÿä¿¡å·
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Context</span>(),         <span style="color:#6272a4">// è®¾ç½® Context 
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Broker</span>(),          <span style="color:#6272a4">// è®¾ç½®å†…éƒ¨ broker æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Registry</span>(),        <span style="color:#6272a4">// è®¾ç½®å†…éƒ¨ Registry æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">RegisterTTL</span>(),     <span style="color:#6272a4">// æœåŠ¡æ³¨å†Œæœ‰æ•ˆæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">RegisterInterval</span>(), <span style="color:#6272a4">// æœåŠ¡æ³¨å†Œé—´éš”ï¼Œå¿…é¡»å°äº ttl
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Tracer</span>(),          <span style="color:#6272a4">// è®¾ç½® Trace æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Dialect</span>(),         <span style="color:#6272a4">// è®¾ç½® Dialect æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Cmd</span>(),             <span style="color:#6272a4">// è®¾ç½® Cmd æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Action</span>(),          <span style="color:#6272a4">// è®¾ç½® Cmd Action å›è°ƒå‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">Flags</span>(),           <span style="color:#6272a4">// æ·»åŠ  Cmd Flags 
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">WrapHandler</span>(),     <span style="color:#6272a4">// æ·»åŠ  Server è¯·æ±‚æ‹¦æˆªå™¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">WrapClient</span>(),      <span style="color:#6272a4">// æ·»åŠ  Client è¯·æ±‚æ‹¦æˆªå™¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">WrapCall</span>(),        <span style="color:#6272a4">// æ·»åŠ  Client Call è¯·æ±‚æ‹¦æˆªå™¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">WrapSubscriber</span>(),  <span style="color:#6272a4">// æ·»åŠ  Broker æ‹¦æˆªå™¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">BeforeStart</span>(),     <span style="color:#6272a4">// è¿½åŠ æœåŠ¡ Start æ–¹æ³•å‰çš„å›è°ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">BeforeStop</span>(),      <span style="color:#6272a4">// è¿½åŠ æœåŠ¡ Stop æ–¹æ³•å‰çš„å›è°ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">AfterStart</span>(),      <span style="color:#6272a4">// è¿½åŠ æœåŠ¡ Start æ–¹æ³•åçš„å›è°ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>vine.<span style="color:#50fa7b">AfterStop</span>(),       <span style="color:#6272a4">// è¿½åŠ æœåŠ¡ Stop æ–¹æ³•åçš„å›è°ƒ
</span></span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6315071e53a7aa2cbc40cd1587b5d32b">6 - æ’ä»¶ä¸­å¿ƒ</h1>
    
	<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2>
<p><strong>Vine</strong> æ„å»ºåœ¨ Go æ¥å£ä¹‹ä¸Šã€‚å› æ­¤è¿™äº›æ¥å£çš„å®ç°æ˜¯å¯æ’æ‹”çš„ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>Vine</strong> åªæä¾›æ ¸å¿ƒä¸Šæ¯ä¸ªæ¥å£çš„å‡ ä¸ªå®ç°ï¼Œä½†å®ƒå®Œå…¨æ˜¯å¯æ’æ‹”çš„ã€‚è€Œé¢å¤–çš„å®ç°ä¿å­˜åœ¨ <a href="https://github.com/vine-io/plugins">plugins</a>ã€‚</p>
<h2 id="æ·»åŠ æ’ä»¶">æ·»åŠ æ’ä»¶</h2>
<p>å¦‚æœè¦é›†æˆæ’ä»¶ï¼Œåªéœ€å°†å®ƒä»¬é“¾æ¥åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­å¹¶é‡æ–°ç”Ÿæˆã€‚
åˆ›å»º plugins.go æ–‡ä»¶å¹¶å¯¼å…¥æ‰€éœ€çš„æ’ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// etcd registry
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    _ <span style="color:#f1fa8c">&#34;github.com/vine-io/plugins/registry/etcd&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// nats broker
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    _ <span style="color:#f1fa8c">&#34;github.com/vine-io/plugins/broker/nats&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>é€šè¿‡åŒ…å«æ’ä»¶æ–‡ä»¶æ¥æ„å»ºåº”ç”¨ç¨‹åºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go build -o service main.go plugins.go
</span></span></code></pre></div><p>ä½¿ç”¨æ’ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>service --registry<span style="color:#ff79c6">=</span>etcd --broker<span style="color:#ff79c6">=</span>nats
</span></span></code></pre></div><p>æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">VINE_REGISTRY</span><span style="color:#ff79c6">=</span>etcd <span style="color:#8be9fd;font-style:italic">VINE_BROKER</span><span style="color:#ff79c6">=</span>nats service
</span></span></code></pre></div><h2 id="æ’ä»¶é€‰é¡¹">æ’ä»¶é€‰é¡¹</h2>
<p>æˆ–è€…ä½ å¯ä»¥å°†æ’ä»¶è®¾ç½®åœ¨é€‰é¡¹ä¸­</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;github.com/vine-io/vine&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// etcd registry
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#f1fa8c">&#34;github.com/vine-io/plugins/registry/etcd&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// nats broker
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#f1fa8c">&#34;github.com/vine-io/plugins/broker/nats&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    registry <span style="color:#ff79c6">:=</span> etcd.<span style="color:#50fa7b">NewRegistry</span>()
</span></span><span style="display:flex;"><span>    broker <span style="color:#ff79c6">:=</span> nats.<span style="color:#50fa7b">NewBroker</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    service <span style="color:#ff79c6">:=</span> vine.<span style="color:#50fa7b">NewService</span>(
</span></span><span style="display:flex;"><span>        vine.<span style="color:#50fa7b">Name</span>(<span style="color:#f1fa8c">&#34;greeter&#34;</span>),
</span></span><span style="display:flex;"><span>        vine.<span style="color:#50fa7b">Registry</span>(registry),
</span></span><span style="display:flex;"><span>        vine.<span style="color:#50fa7b">Broker</span>(broker),
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    service.<span style="color:#50fa7b">Init</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    service.<span style="color:#50fa7b">Run</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="ç¼–å†™æ’ä»¶">ç¼–å†™æ’ä»¶</h2>
<p>æ’ä»¶æ˜¯ä¸€ä¸ªå»ºç«‹åœ¨ Go æ¥å£ä¸Šçš„æ¦‚å¿µã€‚æ¯ä¸ªåŒ…éƒ½ç»´æŠ¤ä¸€ä¸ªé«˜çº§æ¥å£æŠ½è±¡ã€‚åªéœ€å®ç°æ¥å£å¹¶å°†å…¶ä½œä¸ºæœåŠ¡é€‰é¡¹ä¼ é€’ç»™å®ƒå³å¯.</p>
<p>æœåŠ¡å‘ç°æ¥å£ç§°ä¸º <a href="https://pkg.go.dev/github.com/vine-io/vine/core/registry#Registry">Registry</a>. å®ç°æ­¤æ¥å£çš„ä»»ä½•å†…å®¹éƒ½å¯ä»¥ç”¨ä½œ <strong>Registry</strong>ã€‚è¿™åŒæ ·é€‚ç”¨äºå…¶ä»–åŒ….</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> Registry <span style="color:#8be9fd;font-style:italic">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">Init</span>(<span style="color:#ff79c6">...</span>Option) <span style="color:#8be9fd">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">Options</span>() Options
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">Register</span>(<span style="color:#ff79c6">*</span>Service, <span style="color:#ff79c6">...</span>RegisterOption) <span style="color:#8be9fd">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">Deregister</span>(<span style="color:#ff79c6">*</span>Service, <span style="color:#ff79c6">...</span>DeregisterOption) <span style="color:#8be9fd">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">GetService</span>(<span style="color:#8be9fd">string</span>, <span style="color:#ff79c6">...</span>GetOption) ([]<span style="color:#ff79c6">*</span>Service, <span style="color:#8be9fd">error</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">ListServices</span>(<span style="color:#ff79c6">...</span>ListOption) ([]<span style="color:#ff79c6">*</span>Service, <span style="color:#8be9fd">error</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">Watch</span>(<span style="color:#ff79c6">...</span>WatchOption) (Watcher, <span style="color:#8be9fd">error</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#50fa7b">String</span>() <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æŸ¥é˜… <a href="https://github.com/vine-io/plugins">plugins</a> å¯ä»¥æ›´å¥½åœ°äº†è§£å®ç°ç»†èŠ‚ã€‚</p>
<h2 id="æ’ä»¶åˆ—è¡¨">æ’ä»¶åˆ—è¡¨</h2>
<p>Registry æ’ä»¶:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/registry/etcd">etcd</a></li>
</ul>
<p>Broker æ’ä»¶:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/broker/nats">nats</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/broker/redis">redis</a></li>
</ul>
<p>Dao æ’ä»¶:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/dao/mysql">mysql</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/dao/postgres">postgresql</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/dao/sqlite">sqlite</a></li>
</ul>
<p>Cache æ’ä»¶:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/cache/redis">redis</a></li>
</ul>
<p>Sync æ’ä»¶ï¼š</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/sync/etcd">etcd</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/sync/memory">memory</a></li>
</ul>
<p>Logger æ’ä»¶:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/logger/zap">zap</a></li>
</ul>
<p>Config Source æ’ä»¶ï¼š</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/config/source/configmap">configmap</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/config/source/etcd">etcd</a></li>
</ul>
<p>Wrapper ç±»</p>
<p>ç†”æ–­å™¨:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/wrapper/breaker/gobreaker">gobreaker</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/wrapper/breaker/hystrix">hystrix</a></li>
</ul>
<p>é™æµå™¨:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/wrapper/ratelimiter/ratelimiter">ratelimiter</a></li>
<li><a href="https://github.com/vine-io/plugins/tree/main/wrapper/ratelimiter/uber">uber</a></li>
</ul>
<p>é“¾è·¯è¿½è¸ª:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/wrapper/trace/opentracing">opentracing</a></li>
</ul>
<p>æ•°æ®æ ¡éªŒ:</p>
<ul>
<li><a href="https://github.com/vine-io/plugins/tree/main/wrapper/validator">validator</a></li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="" aria-label="">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="">
      <i class=""></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 The Docsy Authors All Rights Reserved</small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank">éšç§æ”¿ç­–</a></small>
	
		<p class="mt-2"><a href="/vine/about/">å…³äº</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.8.1/dist/mermaid.min.js" integrity="sha384-to2w0I1OqmbJ9J6yTnIX+KYU8grNpZoD1dKPLjgEJvMe5L5+/7qvuNa2sQo8WAWj" crossorigin="anonymous"></script>










<script src="/vine/js/main.min.163d123d0686e32440643e7e6a262d74812afcf72ef040b4512877d807100e4e.js" integrity="sha256-Fj0SPQaG4yRAZD5&#43;aiYtdIEq/Pcu8EC0USh32AcQDk4=" crossorigin="anonymous"></script>




  </body>
</html>
